<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Workouts - FitTracker</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Roboto+Slab:wght@400;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="../style.css" />
  <script src="../script.js" defer></script>
  <style>
    body {
      margin-top: 70px;
      margin-bottom: 60px;
    }

    .workout-container {
      max-width: 800px;
      margin: 0 auto;
      padding: 0 20px;
    }

    .card {
      background: white;
      border-radius: 15px;
      padding: 25px;
      margin-bottom: 20px;
      box-shadow: 0 2px 10px rgba(15, 34, 43, 0.08);
    }

    .form-group {
      margin-bottom: 15px;
    }

    label {
      display: block;
      margin-bottom: 8px;
      color: #1c3e4e;
      font-size: 14px;
      font-weight: 600;
    }

    input {
      width: 100%;
      padding: 12px;
      border: 2px solid #daedfa;
      border-radius: 8px;
      font-size: 16px;
      font-family: "Roboto Slab", serif;
      background: white;
      color: #0f222b;
      transition: border-color 0.3s;
    }

    input:focus {
      outline: none;
      border-color: #4297a7;
    }

    .inline-inputs {
      display: grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap: 15px;
    }

    .btn {
      width: 100%;
      padding: 14px;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      font-family: "Roboto Slab", serif;
      transition: all 0.3s;
    }

    .btn-primary {
      background: #4297a7;
      color: white;
    }

    .btn-primary:hover {
      background: #5ab0c1;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(66, 151, 167, 0.3);
    }

    .btn-success {
      background: #28a745;
      color: white;
      margin-top: 20px;
    }

    .btn-success:hover {
      background: #34ce57;
      transform: translateY(-2px);
    }

    .btn-danger {
      background: #dc3545;
      color: white;
      padding: 8px 16px;
      font-size: 14px;
      width: auto;
    }

    .btn-danger:hover {
      background: #e65661;
    }

    .exercise-item {
      background: #f8fafb;
      border-radius: 10px;
      padding: 20px;
      margin-bottom: 15px;
      border-left: 4px solid #4297a7;
    }

    .exercise-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 12px;
    }

    .exercise-name {
      font-weight: 700;
      font-size: 20px;
      color: #0f222b;
    }

    .set-info {
      color: #244f63;
      font-size: 16px;
      margin: 8px 0;
      padding-left: 10px;
    }

    .total-volume {
      color: #4297a7;
      font-weight: 600;
      margin-top: 12px;
      font-size: 15px;
      padding-left: 10px;
    }

    .empty-state {
      text-align: center;
      color: #244f63;
      font-style: italic;
      padding: 40px 20px;
    }

    .workout-stats {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-top: 20px;
      padding-top: 20px;
      border-top: 2px solid #daedfa;
    }

    .stat-box {
      background: #daedfa;
      padding: 20px;
      border-radius: 10px;
      text-align: center;
    }

    .stat-value {
      font-size: 32px;
      font-weight: 900;
      color: #0f222b;
    }

    .stat-label {
      font-size: 14px;
      color: #244f63;
      margin-top: 5px;
      font-weight: 600;
    }

    @media (max-width: 600px) {
      .inline-inputs {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <div class="top-header"></div>

  <header class="top-header">
    <!-- Plus icon on left -->
    <div class="header-left">
      <img src="../icons/plus.png" alt="Add" class="plus-icon" />
    </div>

    <!-- Auth buttons on right -->
    <div class="auth-buttons">
      <button class="login-btn">Log in</button>
      <button class="signup-btn">Sign up</button>
    </div>
  </header>

  <div class="workout-container">
    <h1>Workouts</h1>
    <p>View your favorite <strong>workouts</strong> and build custom <strong>routines</strong>!</p>
    
    <!-- Add Exercise Form -->
    <div class="card">
      <h2>Add Exercise</h2>
      <form id="exerciseForm">
        <div class="form-group">
          <label for="exerciseName">Exercise Name</label>
          <input type="text" id="exerciseName" placeholder="e.g., Bench Press, Squat" required>
        </div>

        <div class="inline-inputs">
          <div class="form-group">
            <label for="sets">Sets</label>
            <input type="number" id="sets" min="1" value="3" required>
          </div>
          <div class="form-group">
            <label for="reps">Reps</label>
            <input type="number" id="reps" min="1" value="10" required>
          </div>
          <div class="form-group">
            <label for="weight">Weight (lbs)</label>
            <input type="number" id="weight" min="0" step="2.5" value="135" required>
          </div>
        </div>

        <button type="submit" class="btn btn-primary">Add Exercise</button>
      </form>
    </div>

    <!-- Current Workout -->
    <div class="card">
      <h2>Today's Workout</h2>
      <div id="exerciseList"></div>
      
      <div class="workout-stats" id="workoutStats" style="display: none;">
        <div class="stat-box">
          <div class="stat-value" id="totalExercises">0</div>
          <div class="stat-label">EXERCISES</div>
        </div>
        <div class="stat-box">
          <div class="stat-value" id="totalVolume">0</div>
          <div class="stat-label">TOTAL VOLUME (LBS)</div>
        </div>
      </div>

      <button id="completeWorkout" class="btn btn-success" style="display: none;">
        Complete Workout
      </button>
    </div>
  </div>

  <!-- Bottom Navigation -->
  <nav class="bottom-nav">
    <a href="index.html" class="nav-item">
      <img src="../icons/home.png" alt="Home" class="nav-icon">
      <span class="nav-text">Home</span>
    </a>
    <a href="calendar.html" class="nav-item">
      <img src="../icons/calendar.png" alt="Calendar" class="nav-icon">
      <span class="nav-text">Calendar</span>
    </a>
    <a href="workouts.html" class="nav-item active">
      <img src="../icons/weight.png" alt="Workouts" class="nav-icon">
      <span class="nav-text">Workouts</span>
    </a>
    <a href="stats.html" class="nav-item">
      <img src="../icons/menu.png" alt="Stats" class="nav-icon">
      <span class="nav-text">Stats</span>
    </a>
    <a href="settings.html" class="nav-item">
      <img src="../icons/settings.png" alt="Settings" class="nav-icon">
      <span class="nav-text">Settings</span>
    </a>
  </nav>

  <!-- Login Modal -->
  <div id="loginModal" class="auth-modal">
    <div class="auth-modal-content">
      <button class="close-modal">&times;</button>
      <h3>Log In to FitTracker</h3>
      <form class="auth-form" id="loginForm">
        <input type="email" class="auth-input" placeholder="Email" required />
        <input type="password" class="auth-input" placeholder="Password" required />
        <button type="submit" class="auth-btn">Log In</button>
      </form>
      <div class="switch-auth">
        <span>Don't have an account? </span>
        <button class="switch-auth-btn" onclick="showSignupModal()">Sign Up</button>
      </div>
    </div>
  </div>

  <!-- Signup Modal -->
  <div id="signupModal" class="auth-modal">
    <div class="auth-modal-content">
      <button class="close-modal">&times;</button>
      <h3>Join FitTracker</h3>
      <form class="auth-form" id="signupForm">
        <input type="text" class="auth-input" placeholder="Full Name" required />
        <input type="email" class="auth-input" placeholder="Email" required />
        <input type="password" class="auth-input" placeholder="Password" required />
        <input type="password" class="auth-input" placeholder="Confirm Password" required />
        <button type="submit" class="auth-btn">Create Account</button>
      </form>
      <div class="switch-auth">
        <span>Already have an account? </span>
        <button class="switch-auth-btn" onclick="showLoginModal()">Log In</button>
      </div>
    </div>
  </div>

  <script>
    // Current workout in memory
    let currentWorkout = [];

    // Load workout on page load
    window.addEventListener('load', () => {
      loadCurrentWorkout();
      displayWorkout();
    });

    // Form submission
    document.getElementById('exerciseForm').addEventListener('submit', (e) => {
      e.preventDefault();
      
      const exercise = {
        name: document.getElementById('exerciseName').value,
        sets: parseInt(document.getElementById('sets').value),
        reps: parseInt(document.getElementById('reps').value),
        weight: parseFloat(document.getElementById('weight').value),
        timestamp: new Date().toISOString()
      };

      addExercise(exercise);
      document.getElementById('exerciseForm').reset();
      
      // Reset to default values
      document.getElementById('sets').value = 3;
      document.getElementById('reps').value = 10;
      document.getElementById('weight').value = 135;
    });

    // Add exercise to workout
    function addExercise(exercise) {
      currentWorkout.push(exercise);
      saveCurrentWorkout();
      displayWorkout();
    }

    // Display current workout
    function displayWorkout() {
      const list = document.getElementById('exerciseList');
      const statsDiv = document.getElementById('workoutStats');
      const completeBtn = document.getElementById('completeWorkout');

      if (currentWorkout.length === 0) {
        list.innerHTML = '<div class="empty-state">No exercises added yet. Start your workout above!</div>';
        statsDiv.style.display = 'none';
        completeBtn.style.display = 'none';
        return;
      }

      // Group by exercise name and calculate volumes
      const grouped = {};
      let totalVolume = 0;

      currentWorkout.forEach(ex => {
        const volume = ex.sets * ex.reps * ex.weight;
        totalVolume += volume;

        if (!grouped[ex.name]) {
          grouped[ex.name] = {
            entries: [],
            totalVolume: 0
          };
        }
        grouped[ex.name].entries.push(ex);
        grouped[ex.name].totalVolume += volume;
      });

      // Display exercises
      list.innerHTML = Object.keys(grouped).map((name, idx) => {
        const data = grouped[name];
        return `
          <div class="exercise-item">
            <div class="exercise-header">
              <div class="exercise-name">${name}</div>
              <button class="btn btn-danger" onclick="removeExercise('${name}')">Remove</button>
            </div>
            ${data.entries.map(ex => `
              <div class="set-info">
                ${ex.sets} sets × ${ex.reps} reps @ ${ex.weight} lbs
              </div>
            `).join('')}
            <div class="total-volume">Total Volume: ${data.totalVolume.toLocaleString()} lbs</div>
          </div>
        `;
      }).join('');

      // Update stats
      document.getElementById('totalExercises').textContent = Object.keys(grouped).length;
      document.getElementById('totalVolume').textContent = totalVolume.toLocaleString();
      statsDiv.style.display = 'grid';
      completeBtn.style.display = 'block';
    }

    // Remove exercise
    function removeExercise(exerciseName) {
      if (confirm(`Remove all sets of ${exerciseName}?`)) {
        currentWorkout = currentWorkout.filter(ex => ex.name !== exerciseName);
        saveCurrentWorkout();
        displayWorkout();
      }
    }

    // Complete workout
    document.getElementById('completeWorkout').addEventListener('click', () => {
      if (currentWorkout.length === 0) return;

      if (confirm('Complete this workout and save to history?')) {
        // Save to workout history
        const workoutHistory = JSON.parse(localStorage.getItem('workoutHistory') || '[]');
        
        const completedWorkout = {
          date: new Date().toISOString(),
          exercises: currentWorkout,
          totalVolume: currentWorkout.reduce((sum, ex) => sum + (ex.sets * ex.reps * ex.weight), 0)
        };
        
        workoutHistory.push(completedWorkout);
        localStorage.setItem('workoutHistory', JSON.stringify(workoutHistory));

        // Clear current workout
        currentWorkout = [];
        localStorage.removeItem('currentWorkout');
        displayWorkout();

        alert('Workout completed! Great job!');
      }
    });

    // Save current workout to localStorage
    function saveCurrentWorkout() {
      localStorage.setItem('currentWorkout', JSON.stringify(currentWorkout));
    }

    // Load current workout from localStorage
    function loadCurrentWorkout() {
      const saved = localStorage.getItem('currentWorkout');
      if (saved) {
        currentWorkout = JSON.parse(saved);
      }
    }
  </script>
</body>
</html>